### redis是键值对数据库

redis里所有的数据都会使用一张哈希表来存储。

具体的数据会根据不同的数据类型用不同的数据结构作为键值对的==值==存储，每个键值对叫做一个==哈希桶==

### 哈希冲突

既然是使用哈希表来存储数据，就必须要面对哈希冲突的问题。redis解决哈希冲突的方法是使用链式哈希。

但是链式哈希在达到一定数量规模之后，还是会导致redis在查找数据时变慢，所以redis还会进行rehash操作。

### rehash

实际上redis在运行中会维护两张全局哈希表。一张用来存取数据，一张用来rehash。

rehash的过程如下：

    首先会有两张全局哈希表，一开始的时候只有哈希表1做数据存取，哈希表2并没有分配空间。
    
    等到需要进行rehash的时候，会给哈希表2分配比哈希表1多一倍的空间。
    
    然后把哈希表1中的数据重新映射拷贝到哈希表2中。
    
    最后释放哈希表1的空间。等下次需要rehash的时候再反过来。

需要注意的是：

    rehash的过程并不是一次性执行完成的，而是在处理客户端请求的时候顺带进行的。这样做的好处就是不会进行大量数据迁移的时候导致线程阻塞，客户端不能访问。
    
### redis支持的数据类型及数据结构的查找时间复杂度

- String(字符串)
    简单动态字符串
- List(列表)
    双向链表 or 压缩列表
- Hash(哈希)
    压缩列表 or 哈希表
- Set(集合)
    哈希表 or 整数数组
- Sorted(有序集合)
    压缩列表 or 跳表

时间复杂度：

数据结构 | 时间复杂度
---|---
哈希表 | O(1)
跳表 | O(logN)
双向链表 | O(N)
压缩列表 | O(N)
整数数组 | O(N)
动态字符串 | O(1)



